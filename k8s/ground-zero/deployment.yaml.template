apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: miner
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: miner
    spec:
      nodeSelector:
        beta.kubernetes.io/os: linux
      containers:
      - name: miner
        image: <<DOCKER_IMAGE_NAME>>
        command:
          - /entrypoint.sh
          - --console-sink
          - --storage-path=/data/miner
          - --peer=<<PUBLIC_KEY>>,52.231.74.24,31234
        volumeMounts:
          - name: volume
            mountPath: /data
        resources:
          requests:
            cpu: 700m
      volumes:
        - name: volume
          persistentVolumeClaim:
            claimName: azurefile

---

apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: seed
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: seed
    spec:
      nodeSelector:
        beta.kubernetes.io/os: linux
      containers:
      - name: seed
        image: <<DOCKER_IMAGE_NAME>>
        command:
          - /scripts/entrypoint.sh
          - --no-miner
          - --console-sink
          - --host=52.231.74.24
          - --port=31234
          - --private-key=<<PRIVATE_KEY>>
          - --storage-path=/data/seed
        livenessProbe:
          failureThreshold: 3
          initialDelaySeconds: 120
          periodSeconds: 5
          successThreshold: 1
          tcpSocket:
            port: 31234
          timeoutSeconds: 1
        ports:
        - containerPort: 31234
          name: seed
        resources:
          requests:
            cpu: 700m
        volumeMounts:
          - name: volume
            mountPath: /data
      volumes:
        - name: volume
          persistentVolumeClaim:
            claimName: azurefile
